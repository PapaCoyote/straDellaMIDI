# VST3 Helper Build Error - Fix Guide

## Error Message

```
Command PhaseScriptExecution failed with a nonzero exit code

Running "/Users/evanstuckless/JUCE/straDellaMIDI/Builds/MacOSX/build/Debug/juce_vst3_helper" > 
  "/Users/evanstuckless/JUCE/straDellaMIDI/Builds/MacOSX/build/Debug/straDellaMIDI.vst3/Contents/Resources/moduleinfo.json"

/Users/evanstuckless/Library/Developer/Xcode/DerivedData/straDellaMIDI-dzfyciokynhwpahafpztbejvzuky/Build/Intermediates.noindex/straDellaMIDI.build/Debug/straDellaMIDI - VST3.build/Script-0F32CBF502486183BA3B50BF.sh: 
  line 5: /Users/evanstuckless/JUCE/straDellaMIDI/Builds/MacOSX/build/Debug/juce_vst3_helper: No such file or directory
```

## What This Error Means

This error occurs during the VST3 plugin build process when Xcode tries to execute `juce_vst3_helper`, a utility program that JUCE uses to generate the VST3 plugin's `moduleinfo.json` metadata file. The error indicates that this helper executable doesn't exist.

## Root Cause

**The Xcode project files were never properly generated by Projucer for plugin builds.**

The `juce_vst3_helper` is a special helper executable that:
1. Is automatically generated by Projucer when you save/export a plugin project
2. Gets built as a separate target in the Xcode project
3. Is used during the VST3 build phase to generate plugin metadata

When the Xcode project files are outdated or not generated for plugins, this helper target is missing, causing the build to fail.

## Why This Happened

Looking at the current state:
- ✅ `straDellaMIDI.jucer` is correctly configured as `projectType="audioplug"` with `pluginFormats="buildAU,buildVST3"`
- ❌ `Builds/MacOSX/straDellaMIDI.xcodeproj` was generated for a standalone application (not plugins)
- ❌ The Xcode project has only 2 VST3 references (should have many more)
- ❌ No `juce_vst3_helper` target exists in the Xcode project

The `.jucer` file was updated to be a plugin, but the Xcode build files were never regenerated from it.

## Solution: Regenerate Build Files with Projucer

### Step 1: Install Projucer (if not already installed)

Download JUCE from [juce.com](https://juce.com/) which includes Projucer.

### Step 2: Open Project in Projucer

```bash
# Option A: If Projucer is your default .jucer handler
open straDellaMIDI.jucer

# Option B: Launch Projucer explicitly
/Applications/JUCE/Projucer.app/Contents/MacOS/Projucer straDellaMIDI.jucer
```

### Step 3: Configure JUCE Module Path

In Projucer:
1. Go to **File → Global Paths**
2. Set "Path to JUCE" to your JUCE installation directory (e.g., `/Applications/JUCE` or `~/JUCE`)
3. This is critical for Projucer to find the JUCE modules

### Step 4: Verify Plugin Configuration

In Projucer, check the project settings (gear icon):
- **Project Type**: Should be "Audio Plug-In"
- **Plugin Formats**: Should have "VST3" and "AU" checked
- **Plugin Characteristics**: 
  - MIDI Effect Plugin: Yes
  - Wants MIDI Input: Yes
  - Produces MIDI Output: Yes

### Step 5: Save/Export Project

Click **"Save Project"** or press **Cmd+S** (macOS) / **Ctrl+S** (Windows)

This will regenerate `Builds/MacOSX/straDellaMIDI.xcodeproj` with:
- ✅ VST3 plugin target
- ✅ AU plugin target  
- ✅ `juce_vst3_helper` build target
- ✅ Proper build scripts and phases
- ✅ Info-VST3.plist and Info-AU.plist files

### Step 6: Build in Xcode

```bash
cd Builds/MacOSX
open straDellaMIDI.xcodeproj
```

In Xcode, you should now see multiple build targets:
- **straDellaMIDI - VST3** (VST3 plugin)
- **straDellaMIDI - AU** (Audio Unit plugin)
- **juce_vst3_helper** (helper utility)

Build the VST3 target first. The `juce_vst3_helper` will be built automatically as a dependency.

### Step 7: Verify Build Output

After successful build, you should have:
```
Builds/MacOSX/build/Debug/
├── juce_vst3_helper               ← This should now exist!
├── straDellaMIDI.vst3/
│   └── Contents/
│       └── Resources/
│           └── moduleinfo.json    ← Generated by juce_vst3_helper
└── straDellaMIDI.component/       (for AU)
```

## Alternative: Command Line Regeneration

If you prefer command line:

```bash
# Navigate to Projucer location
cd /Applications/JUCE/Projucer.app/Contents/MacOS/

# Regenerate build files
./Projucer --resave /path/to/straDellaMIDI/straDellaMIDI.jucer

# Then build
cd /path/to/straDellaMIDI/Builds/MacOSX
xcodebuild -project straDellaMIDI.xcodeproj -target "straDellaMIDI - VST3" -configuration Debug
```

## Understanding juce_vst3_helper

The `juce_vst3_helper` is a small C++ program that:
1. Reads information from the compiled VST3 plugin
2. Extracts metadata (plugin name, version, categories, etc.)
3. Generates `moduleinfo.json` required by the VST3 specification
4. Is built once and reused for all VST3 builds

It's essential for VST3 plugins and is automatically managed by JUCE's build system when properly configured.

## What Changed After Regeneration

Before regeneration (current state):
- Xcode project: ~593 lines
- VST3 references: Only 2
- Build targets: Standalone app only
- No helper executables

After regeneration (expected):
- Xcode project: ~2000+ lines
- VST3 references: 100+
- Build targets: VST3, AU, helpers
- Multiple helper executables and build phases

## Troubleshooting

### Error: "Invalid JUCE modules path"
**Solution**: In Projucer, go to File → Global Paths and set the correct JUCE path.

### Error: Still getting "juce_vst3_helper not found" after regeneration
**Solution**: 
1. Clean build folder: `xcodebuild clean`
2. Delete derived data: `rm -rf ~/Library/Developer/Xcode/DerivedData/straDellaMIDI-*`
3. Build `juce_vst3_helper` target explicitly first
4. Then build VST3 target

### Error: Build fails on `juce_vst3_helper` target
**Solution**: This means the helper source code isn't being found. Regenerate with Projucer ensuring global paths are set correctly.

## Prevention

To prevent this issue in the future:

1. **Always use Projucer** to modify plugin settings
2. **Always regenerate** build files after modifying .jucer file
3. **Never manually edit** Xcode project files for JUCE projects
4. **Commit .jucer file**, not build files (add `Builds/` to `.gitignore`)

## Related Documentation

- [REGENERATE_BUILD_FILES.md](REGENERATE_BUILD_FILES.md) - General regeneration guide
- [VST3_BUILD_GUIDE.md](VST3_BUILD_GUIDE.md) - Complete VST3 build instructions
- [AU_BUILD_FIX.md](AU_BUILD_FIX.md) - AU build error solutions

## Summary

This error is **100% expected** given the current state of the repository. The `.jucer` file was updated for plugins, but the Xcode project wasn't regenerated. Simply open the project in Projucer and save it - this will fix the issue immediately.

**Action Required**: Regenerate build files with Projucer (one-time setup, takes ~30 seconds)
